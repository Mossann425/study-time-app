# 学習時間管理アプリケーション
https://study-time-app-five.vercel.app/
メールアドレス:ppp@ppp
パスワード:pppppp
で実際にログインして使えます。

## 概要

このアプリケーションは、**ユーザーの学習意欲維持と学習習慣の形成**を目的として開発されたWebアプリケーションです。科目ごとの学習時間を記録し、グラフで可視化することで、学習の継続性とモチベーションを高めることを目指しています。

### 🎯 開発の目的
- **学習意欲の維持** - 可視化による達成感の提供
- **学習習慣の形成** - 継続的な記録と振り返り
- **学習効率の向上** - 科目別・時間別の分析
- **目標達成のサポート** - 具体的な学習目標の設定と管理

## 機能

### 🎯 学習目標管理
- 個人の学習目標を設定・管理
- 目標の進捗を視覚的に確認
- **学習意欲維持**: 明確な目標設定によるモチベーション向上

### 📚 科目管理
- 学習科目の追加・編集
- 科目ごとの学習時間記録
- **科目の並び替え**: 直近アクセスした科目やアクセス回数が多い科目を上位に表示
- **学習習慣形成**: 科目別の学習パターン把握
- **ユーザー別フィルタリング**: 各ユーザーは自分の科目のみを表示・管理

### ⏱️ 時間記録
- 科目を選択して学習時間を記録
- コメント機能で学習内容をメモ
- リアルタイムでの記録
- **学習意欲維持**: 即座のフィードバック
- **キャッシュ機能**: 科目データのメモリキャッシュによる高速化
- **即座更新**: 科目選択時の即座なUI更新（データベース再取得なし）

### 📊 学習分析
- 日別・科目別の学習時間グラフ
- **グラフ表示切り替え**: 日毎・週ごと・月毎で学習時間の推移を切り替え表示
- **期間選択機能**: 年・月を選択して特定期間のデータを表示
- 総学習時間の表示
- 学習パターンの可視化
- **学習習慣形成**: 継続的な学習の可視化
- **パフォーマンス最適化**: useMemo/useCallbackによる計算結果と関数のキャッシュ
- **レスポンシブグラフ**: データ量に応じた動的な棒グラフ幅調整
- **スクロール対応**: 大量データ時の横スクロール表示

### 📝 学習ログ
- 過去の学習記録を確認
- コメント付きの詳細ログ
- 最新20件の記録を表示
- **学習意欲維持**: 過去の努力の振り返り

### 🗄️ データ管理
- 古いデータの自動集約と削除
- パフォーマンス最適化
- 手動データ移行機能
- **データ効率化**: 直近20件以外のデータを日別集約してから削除
- **リアルタイム集約**: データ登録時に即座に合計値を更新

### 🛠️ 開発者機能（開発環境のみ）
- **テストデータ生成**: パフォーマンステスト用の大量データ生成
- **テストデータ削除**: テストデータの一括削除
- **環境分離**: 開発環境でのみ利用可能な機能

## 技術スタック

### フロントエンド
- **Next.js 14** - React フレームワーク
- **TypeScript** - 型安全な開発
- **Tailwind CSS** - スタイリング
- **shadcn/ui** - UI コンポーネント
- **React Hooks** - useMemo, useCallbackによるパフォーマンス最適化

### バックエンド
- **Supabase** - データベース・認証
- **PostgreSQL** - リレーショナルデータベース

### 認証
- **Supabase Auth** - ユーザー認証
- **JWT** - セッション管理

### パフォーマンス最適化
- **メモリキャッシュ** - フロントエンドでのデータキャッシュ
- **計算結果キャッシュ** - 重い計算処理のメモ化
- **関数キャッシュ** - コールバック関数のメモ化

## 主要コンポーネントの詳細

### TimeRecorder（時間記録）
**学習習慣形成の核となるコンポーネント**
- **機能**: 科目選択、時間入力、コメント記録
- **学習意欲維持**: 即座の記録による達成感
- **学習習慣形成**: 毎日の記録が習慣化を促進
- **パフォーマンス最適化**: 
  - メモリキャッシュによる科目データの高速取得
  - 科目選択時の即座なUI更新
  - 重複データベースアクセスの防止
  - キャッシュ有効期限管理（5分）
- **セキュリティ**: ユーザー別の科目フィルタリング

### StudyChart（学習時間グラフ）
**学習意欲維持のための可視化コンポーネント**
- **機能**: 日別・週別・月別学習時間の棒グラフ表示
- **学習意欲維持**: 継続的な学習の可視化
- **学習習慣形成**: 学習パターンの把握
- **パフォーマンス最適化**:
  - useMemoによる計算結果のキャッシュ
  - useCallbackによる関数のメモ化
  - 事前計算済みデータの活用
  - ホバー時の即座なツールチップ表示
- **UI/UX改善**:
  - データ量に応じた動的な棒グラフ幅調整
  - 大量データ時の横スクロール対応
  - 日付ラベルの読みやすさ向上
  - 色分けによる学習時間の視覚的表現

### ReviewPage（学習分析ページ）
**学習データの分析と可視化**
- **機能**: 期間選択、グラフ表示、統計情報
- **期間選択**: 年・月を選択して特定期間のデータを表示
- **表示モード**: 日別・週別・月別の切り替え
- **データ処理**:
  - 期間限定での効率的なデータ取得
  - 選択された年・月に基づく正確なデータフィルタリング
  - 週別表示での月内週番号計算
- **パフォーマンス測定**: データ取得時間の計測とログ出力

### StudyLog（学習ログ）
**学習継続のモチベーション向上コンポーネント**
- **機能**: 過去の学習記録とコメント表示
- **学習意欲維持**: 過去の努力の振り返り
- **学習習慣形成**: 継続性の実感

### SubjectManager（科目管理）
**学習計画構築のためのコンポーネント**
- **機能**: 科目の追加・編集・管理
- **学習意欲維持**: 体系的な学習計画
- **学習習慣形成**: 科目別の学習習慣

### PageHeader（ページヘッダー）
**ナビゲーションとユーザー体験向上**
- **機能**: ページ間の移動、ログアウト
- **学習意欲維持**: スムーズな操作体験
- **学習習慣形成**: 直感的な操作で継続を促進

## データベース設計

### users テーブル（ユーザー情報）
- `id`: ユーザーID（auth.users と連携）
- `name`: ユーザー名
- `study_goal`: 学習目標（学習意欲維持のため）
- `created_at`: 作成日時

### subjects テーブル（科目管理）
- `id`: 科目ID
- `name`: 科目名
- `user_id`: ユーザーID（外部キー）
- `created_at`: 作成日時
- `access_count`: アクセス数（int, 科目が選択された回数）
- `last_accessed_at`: アクセス時刻（timestampz, 直近アクセス日時）

### study_times テーブル（学習時間記録）
- `id`: 学習時間ID
- `user_id`: ユーザーID（外部キー）
- `subject_id`: 科目ID（外部キー）
- `time`: 学習時間（分）
- `comment`: コメント（学習内容の記録）
- `created_at`: 作成日時（学習習慣の追跡）

### study_time_summaries テーブル（学習時間集約）
- `id`: 集約ID
- `user_id`: ユーザーID（外部キー）
- `date`: 日付
- `total_time`: その日の総学習時間（分）
- `record_count`: その日の記録数
- `created_at`: 作成日時
- `updated_at`: 更新日時

## パフォーマンス最適化

### フロントエンドキャッシュ
- **メモリキャッシュ**: 科目データの5分間キャッシュ
- **計算結果キャッシュ**: グラフ計算結果のメモ化
- **関数キャッシュ**: コールバック関数のメモ化
- **重複実行防止**: 同時実行の防止

### データベース最適化
- **ユーザー別フィルタリング**: 必要なデータのみ取得
- **期間限定取得**: 表示期間に応じた効率的なクエリ
- **型安全なクエリ**: 必要なカラムのみを選択
- **データ集約**: 古いデータを日別集約テーブルに移行してから削除
- **自動データ管理**: 直近20件を保持し、古いデータを自動集約・削除
- **リアルタイム集約**: データ登録時に即座に合計値を更新

### UI/UX最適化
- **即座の反応**: キャッシュによる高速なUI更新
- **レスポンシブデザイン**: データ量に応じた動的調整
- **スクロール対応**: 大量データの適切な表示

## セキュリティ

### データアクセス制御
- **RLS（Row Level Security）**: ユーザー別データアクセス制御
- **ユーザー認証**: Supabase Authによる安全な認証
- **データフィルタリング**: フロントエンドでのユーザー別フィルタリング

### 環境分離
- **開発環境**: テストデータ生成・削除機能
- **本番環境**: セキュアな運用環境

## 学習意欲維持・習慣形成のための設計思想

### 🎯 継続性の重視
- **毎日の記録**: 学習時間の継続的な記録
- **可視化**: グラフによる学習パターンの可視化
- **振り返り**: 過去の学習記録の確認

### 📈 モチベーション向上
- **目標設定**: 明確な学習目標の設定
- **達成感**: 即座の記録による達成感
- **成長実感**: 学習時間の蓄積による成長実感

### 🔄 習慣化の促進
- **シンプル操作**: 直感的で簡単な操作
- **即座フィードバック**: 記録後の即座の確認
- **継続的改善**: 学習パターンの分析と改善

### ⚡ パフォーマンス重視
- **高速レスポンス**: キャッシュによる即座の反応
- **スムーズな操作**: 最適化されたUI/UX
- **効率的なデータ処理**: 必要最小限のデータ取得

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

## 貢献

プルリクエストやイシューの報告を歓迎します。

## サポート

問題や質問がある場合は、GitHub のイシューを作成してください。 
